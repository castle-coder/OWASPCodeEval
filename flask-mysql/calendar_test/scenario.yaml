tests:
  - id: A1_BrokenAccess_Edit
    description: 일반 사용자가 다른 사용자의 게시글 수정 시도
    endpoint: "/calendar/edit/2"
    method: POST
    payload:
      title: "해킹"
      event_date: "2025-05-01 12:00:00"
      description: "수정 시도"
    expected_status: 403
    check_db: false

  - id: A1_BrokenAccess_Delete
    description: 일반 사용자가 다른 사용자의 게시글 삭제 시도
    endpoint: "/calendar/delete/2"
    method: POST
    expected_status: 403
    check_db: false

  - id: A1_BrokenAccess_Block
    description: 일반 사용자가 게시글 차단 시도
    endpoint: "/admin/block/1"
    method: POST
    expected_status: 403
    check_db: false

  - id: A1_SQLi
    description: SQL Injection 테스트
    endpoint: "/calendar"
    method: POST
    payload:
      title: "제목'); DROP TABLE users; --"
      event_date: "2025-05-02 10:00:00"
      description: "악성 SQL 삽입"
    expected_status: 302
    check_db: true
    check_title: "제목'); DROP TABLE users; --"

  - id: A3_XSS
    description: XSS 테스트
    endpoint: "/calendar"
    method: POST
    payload:
      title: "<script>alert(1)</script>"
      event_date: "2025-05-03 10:00:00"
      description: "스크립트 삽입"
    expected_status: 302
    check_db: true
    check_title: "<script>alert(1)</script>"

  - id: A7_MissingAuth
    description: 로그인하지 않고 일정 작성 시도
    endpoint: "/calendar"
    method: POST
    payload:
      title: "비로그인 작성"
      event_date: "2025-05-04 10:00:00"
      description: "로그인 필요 테스트"
    expected_status: 401
    unauthenticated: true
    check_db: false

  - id: A9_InsufficientLogging
    description: 신고 기능 악성 입력
    endpoint: "/calendar/report/1"
    method: POST
    payload:
      reason: "<img src=x onerror=alert(1)>"
    expected_status: 302
    check_db: true
    check_report_reason: "<img src=x onerror=alert(1)>"
