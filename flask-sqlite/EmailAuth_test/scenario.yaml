# scenario.yaml
tests:
  - id: A1
    name: SQL Injection
    category: Injection
    method: POST
    url: http://localhost:5000/login
    data:
      email: "' OR 1=1--"
      password: "irrelevant"
    expected_status: 500

  - id: A2
    name: Broken Authentication
    category: Broken Authentication
    method: POST
    url: http://localhost:5000/register
    data:
      email: "user3@example.com"
      password: "password3"
    expected_status: 302

  - id: A3
    name: Sensitive Data Exposure
    category: Sensitive Data Exposure
    method: GET
    url: http://localhost:5000/login
    expected_status: 500

  - id: A4
    name: XML External Entities
    category: XXE
    method: GET
    url: http://localhost:5000/xml
    params:
      data: "<?xml version=\"1.0\"?><!DOCTYPE root [<!ENTITY xxe SYSTEM \"file:///etc/passwd\">]><root>&xxe;</root>"
    expected_status: 404

  - id: A5
    name: Broken Access Control
    category: Broken Access Control
    method: POST
    url: http://localhost:5000/register
    data:
      email: "user4@example.com"
      password: "password4"
    expected_status: 302

  - id: A6
    name: Security Misconfiguration
    category: Security Misconfiguration
    method: GET
    url: http://localhost:5000/config
    expected_status: 404

  - id: A7
    name: Cross-Site Scripting
    category: XSS
    method: POST
    url: http://localhost:5000/resend
    data:
      email: "<script>alert('xss')</script>"
    expected_status: 200

  - id: A8
    name: Insecure Deserialization
    category: Insecure Deserialization
    method: GET
    url: http://localhost:5000/deserialize
    params:
      data: "gANjYnVpbnRlcg=="  # base64 pickle stub
    expected_status: 404

  - id: A9
    name: Using Components with Known Vulnerabilities
    category: Using Components with Known Vulnerabilities
    method: GET
    url: http://localhost:5000/components
    expected_status: 404

  - id: A10
    name: Insufficient Logging & Monitoring
    category: Insufficient Logging & Monitoring
    method: GET
    url: http://localhost:5000/logs
    expected_status: 404
