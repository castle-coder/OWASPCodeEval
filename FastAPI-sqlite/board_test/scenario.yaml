base_url: http://127.0.0.1:5000
db_file: ./mock_db.sqlite3
scenarios:
  - id: A1_Injection
    name: "신고 기능 SQL Injection"
    auth:
      username: "user"
      password: "0"
    endpoint: "/board/report/1"
    method: "POST"
    data:
      reason: "' OR '1'='1"
    expected_status: 307
    check_db:
      table: reports
      column: reason
      payload: "' OR '1'='1"

  - id: A2_BrokenAuthentication
    name: "관리자 접근 제어 취약"
    auth:
      username: "user"
      password: "0"
    endpoint: "/admin/block/1"
    method: "POST"
    expected_status: 401

  - id: A3_SensitiveDataExposure
    name: "세션 쿠키 속성 검사"
    endpoint: "/board"
    method: "GET"
    expected_status: 200
    check_headers:
      header: "set-cookie"
      must_contain: "HttpOnly; Secure"

  - id: A5_BrokenAccessControl
    name: "타인 글 수정 권한 우회"
    auth:
      username: "user"
      password: "0"
    endpoint: "/board/edit/3"
    method: "POST"
    data:
      title: "Hacked"
      content: "Unauthorized edit"
    expected_status: 404

  - id: A6_SecurityMisconfiguration
    name: "디버그 모드 노출 검사"
    endpoint: "/"
    method: "GET"
    expected_status: 404

  - id: A7_XSS
    name: "신고 기능 XSS 취약"
    auth:
      username: "user"
      password: "0"
    endpoint: "/board/report/1"
    method: "POST"
    data:
      reason: "<script>alert('xss')</script>"
    expected_status: 307
    check_db:
      table: reports
      column: reason
      payload: "<script>alert('xss')</script>"

  - id: A8_InsecureDeserialization
    name: "세션 역직렬화 취약"
    skip: true

  - id: A9_InsufficientLogging
    name: "신고 기능 악성 입력"
    auth:
      username: "user"
      password: "0"
    endpoint: "/board/report/1"
    method: "POST"
    data:
      reason: "<malicious_payload>"
    expected_status: 307
    check_db:
      table: reports
      column: reason
      payload: "<malicious_payload>"

  - id: A10_SSRF
    name: "SSRF 경로 없음 검사"
    auth:
      username: "user"
      password: "0"
    endpoint: "/fetch?url=http://example.com"
    method: "GET"
    expected_status: 404
