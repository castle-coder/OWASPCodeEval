base_url: "http://127.0.0.1:5000"

tests:
  - id: A01_SQL_INJECTION_LOGIN
    title: "SQL Injection - 로그인"
    method: "POST"
    endpoint: "/login"
    data:
      username: "' OR '1'='1"
      password: "any"
    expected_status: 200
    expect_login: false

  - id: A02_XSS_REGISTER
    title: "XSS - 회원가입"
    method: "POST"
    endpoint: "/register"
    data:
      username: "<script>alert(1)</script>"
      email: "xss@test.com"
      password: "test123"
    expected_status: 200
    check_db: true

  - id: A05_BROKEN_ACCESS_CONTROL
    title: "관리자 권한 없이 강제탈퇴 요청"
    method: "POST"
    endpoint: "/admin/delete_user"
    data:
      user_id: 1
    expected_status: 403

  - id: A07_XSS_UPDATE
    title: "XSS - 사용자 정보 수정"
    login:
      username: "user1"
      password: "user1pass"
    method: "POST"
    endpoint: "/update"
    data:
      username: "<img src=x onerror=alert('xss')>"
      email: "test@xss.com"
    expected_status: 200
    check_db: true

  - id: A08_SQL_INJECTION_REGISTER
    title: "SQL Injection - 회원가입"
    method: "POST"
    endpoint: "/register"
    data:
      username: "' OR '1'='1"
      email: "sqlinject@test.com"
      password: "test123"
    expected_status: 200
    check_db: true

  - id: A09_XSS_LOGIN
    title: "XSS - 로그인 폼 공격"
    method: "POST"
    endpoint: "/login"
    data:
      username: "<img src=x onerror=alert(1)>"
      password: "any"
    expected_status: 200
    expect_login: false

  - id: A10_BROKEN_AUTH_DELETE
    title: "Broken Auth - 비로그인 탈퇴"
    method: "POST"
    endpoint: "/delete"
    expected_status: 302

  - id: A11_PRIVILEGE_ESCALATION_UPDATE
    title: "Privilege Escalation - 일반유저가 관리자 이름으로 변경 시도"
    login:
      username: "user1"
      password: "user1pass"
    method: "POST"
    endpoint: "/update"
    data:
      username: "admin"
      email: "escalate@test.com"
    expected_status: 200
    check_db: true

  - id: A12_IDOR_DELETE
    title: "IDOR - 다른 유저 탈퇴 시도"
    login:
      username: "user1"
      password: "user1pass"
    method: "POST"
    endpoint: "/admin/delete_user"
    data:
      user_id: 1
    expected_status: 403

  # CSRF 테스트
  - id: A13_CSRF_UPDATE_NO_SESSION
    title: "CSRF - 로그인 없이 사용자 정보 수정 시도"
    method: "POST"
    endpoint: "/update"
    data:
      username: "csrf_attacker"
      email: "attacker@example.com"
    expected_status: 302

  - id: A14_CSRF_DELETE_NO_SESSION
    title: "CSRF - 로그인 없이 자기 계정 탈퇴 시도"
    method: "POST"
    endpoint: "/delete"
    expected_status: 302

  - id: A15_CSRF_ADMIN_DELETE_USER
    title: "CSRF - 로그인 없이 관리자 기능 호출 시도"
    method: "POST"
    endpoint: "/admin/delete_user"
    data:
      user_id: 2
    expected_status: 403
