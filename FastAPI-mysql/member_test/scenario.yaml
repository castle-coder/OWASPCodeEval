# scenario.yaml
scenarios:
  - id: A1_BrokenAccess_Edit
    description: "일반 사용자가 다른 사용자의 게시글 수정 시도"
    method: POST
    endpoint: /board/edit/2
    login:
      user_id: 1
    data:
      title: "New Title"
      content: "Changed content"
    expected_status: 403

  - id: A1_BrokenAccess_Delete
    description: "일반 사용자가 다른 사용자의 게시글 삭제 시도"
    method: POST
    endpoint: /board/delete/2
    login:
      user_id: 1
    expected_status: 403

  - id: A1_BrokenAccess_Block
    description: "일반 사용자가 게시글 차단 시도"
    method: POST
    endpoint: /admin/block/2
    login:
      user_id: 1
    expected_status: 403

  - id: A1_SQLi
    description: "SQL Injection 테스트"
    method: POST
    endpoint: /board
    login:
      user_id: 1
    data:
      title: "Test'); INSERT INTO boards (user_id, title, content) VALUES (1, 'Injected', 'SQLi'); --"
      content: "SQL injection content"
    expected_status: 400

  - id: A3_XSS
    description: "XSS 테스트"
    method: POST
    endpoint: /board
    login:
      user_id: 1
    data:
      title: "<script>alert('XSS')</script>"
      content: "<img src=x onerror=alert(1) />"
    expected_status: 400

  - id: A7_MissingAuth
    description: "로그인하지 않고 게시글 작성 시도"
    method: POST
    endpoint: /board
    data:
      title: "NoAuth"
      content: "Should be unauthorized"
    expected_status: 401

  - id: A9_InsufficientLogging
    description: "신고 기능 악성 입력"
    method: POST
    endpoint: /board/report/1
    login:
      user_id: 1
    data:
      reason: "<script>malicious()</script>"
    expected_status: 400
